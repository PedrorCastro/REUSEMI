<!DOCTYPE html>
<html lang="pt-BR">
<head>
 <meta charset="UTF-8">
 <title>Anunciar Item</title>
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
 <header>
  <div class="container">
   <h1>REUSEMI</h1>
   <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
        <a class="navbar-brand" href="{{ url_for('index') }}">REUSEMI</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="{{ url_for('index') }}">Início</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('categorias') }}">Categorias</a>
                </li>
                {% if 'usuario_id' in session %}
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('perfil') }}">Meu Perfil</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('anunciar') }}">Anunciar</a>  </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('logout') }}">Sair</a>
                </li>
                {% else %}
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('login') }}">Entrar</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('cadastro') }}">Cadastrar</a>
                </li>
                {% endif %}
            </ul>
        </div>
    </div>
</nav>
  </div>
 </header>

 <section class="hero">
  <div class="container">
   <h2>Anuncie seu Item</h2>
   <form id="anunciarForm">
    <label for="nome">Nome do Item:</label><br>
    <input type="text" id="nome" name="nome" required><br>

    <label for="descricao">Descrição:</label><br>
    <textarea id="descricao" name="descricao" rows="4" cols="50"></textarea><br>

    <label for="categoria">Categoria:</label><br>
    <select id="categoria" name="categoria">
     <option value="roupas">Roupas</option>
     <option value="eletronicos">Eletrônicos</option>
     <option value="livros">Livros</option>
     </select><br>

    <label for="cidade">Cidade:</label><br>
    <input type="text" id="cidade" name="cidade" required><br>

    <button type="submit" class="btn">Anunciar</button>
   </form>
  </div>
 </section>

 <footer>
  <div class="container">
   <p>&copy; 2025 REUSEMI.</p>
  </div>
 </footer>

 <script>
  document.getElementById('anunciarForm').addEventListener('submit', function(event) {
   event.preventDefault();

   const nome = document.getElementById('nome').value;
   const descricao = document.getElementById('descricao').value;
   const categoria = document.getElementById('categoria').value;
   const cidade = document.getElementById('cidade').value;

   fetch('/anunciar', {
    method: 'POST',
    headers: {
     'Content-Type': 'application/json'
    },
    body: JSON.stringify({ nome, descricao, categoria, cidade })
   })
    .then(response => response.json())
    .then(data => {
     if (data.status === 'success') {
      alert('Item anunciado com sucesso!');
      window.location.href = 'index.html';  // Redireciona para a página inicial
     } else {
      alert('Erro ao anunciar item: ' + data.message);
     }
    })
    .catch(error => {
     console.error('Erro:', error);
     alert('Erro ao comunicar com o servidor.');
    });
  });
 </script>
</body>
</html>